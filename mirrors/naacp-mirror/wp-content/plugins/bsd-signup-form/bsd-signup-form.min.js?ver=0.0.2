!function(e,t,s){function a(e){var t=document.createElement("a");return t.href=e,t}function r(t){var s="No response from sever";if(t&&t.responseJSON)return t.responseJSON;try{return e.parseJSON(t.responseText)}catch(a){return{status:"fail",code:503,message:s,error:s}}}function i(t){return t&&"success"===t.status?t:e.Deferred().rejectWith(this,[t])}function n(e,t,s){e.one("change keyup",function(){e.val()!==s&&t.setCustomValidity("")})}function o(e){this.trigger("bsd-success",[e]),this.data("bsdsignup").no_redirect!==!0&&e.thanks_url&&(t.href=e.thanks_url)}function u(t){var s=this,a=!1,r=this.data("bsdsignup"),i={};t&&t.field_errors&&t.field_errors.length&&(e.each(t.field_errors,function(e,o){var u=s.find('[name="'+o.field+'"]'),d=u.get()[0];"submit-btn"===o.field?t.message=o.message:d&&d.setCustomValidity&&l&&!s[0].noValidate&&!r.no_html5validate&&(d.setCustomValidity(o.message),n(u,d,o.message),a=!0),o.$field=u,i[o.field]=o.message,u.trigger("invalid",o.message)}),a&&l&&s.find('[type="submit"],[type="image"]').eq(0).click()),s.trigger("bsd-error",[t,i])}function d(s,n,d){return function(c){if(s.data("isPaused")!==!0){s.data("isPaused",!0);var l=s.serializeObject(),f=n.replace(/\/page\/(signup|s)/,"/page/sapi"),p=e.ajax({url:f,type:"POST",method:"POST",dataType:"json",timeout:d.timeout||3e4,context:s,data:l,beforeSend:function(s,r){if(d.proxyall||r.crossDomain&&!e.support.cors&&(!e.oldiexdr||a(r.url).protocol!==t.protocol)){if(!d.oldproxy&&!d.proxyall)return!1;r.url=d.oldproxy||d.proxyall,r.crossDomain=!1,r.data+="&purl="+f}c.preventDefault()}});"canceled"!==p.statusText&&(s.trigger("bsd-submit",l),p.then(i,r).always(function(){s.data("isPaused",!1)}).done(o).fail(u))}else c.preventDefault()}}function c(t,s,a){var r,i=t.find('[name="'+s+'"]');i.length||(i=e("<input/>",{type:"hidden",name:s}).appendTo(t)),a&&(r=i.val(),i.val((""!==r?r+",":"")+a))}e.fn.serializeObject=function(){var t={},a=this.serializeArray();return e.each(a,function(){t[this.name]!==s?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t};var l="reportValidity"in e("<form/>").get()[0],f=function(e){var s=new RegExp("[\\?&]"+e.replace(/(\[|\])/g,"\\$1")+"=([^&#]*)"),a=s.exec(t.href);return null===a?"":a[1]},p="source",m="subsource",h=f(p)||f("fb_ref"),g=f(m);e.fn.bsdSignup=function(t){return t=t||{},this.each(function(){var s=e(this),a=s.attr("action");"remove"===t?s.off("submit.bsdsignup").removeData("bsdsignup isPaused"):s.is("form")&&a.indexOf("page/s")>-1&&(s.data("bsdsourced")===!0||t.nosource||(c(s,p,h),c(s,m,g),s.data("bsdsourced",!0)),s.data("bsdsignup",t),t.startPaused&&s.data("isPaused",!0),s.on("submit.bsdsignup",d(s,a,t)))})}}(jQuery,window.location);